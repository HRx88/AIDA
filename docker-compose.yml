services:
  calendar-service:
    build:
      context: ./Calendar-service
      dockerfile: Dockerfile
    ports:
      - "5003:5003"
    env_file:
      - ./.env
    environment:
      - CALENDAR_SERVICE_PORT=5003
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "node", "-e", "fetch('http://localhost:5003/health').then(r=>process.exit(r.ok?0:1)).catch(()=>process.exit(1))"]
      interval: 10s
      timeout: 5s
      retries: 10

  frontend-service:
    build:
      context: ./Frontend-service
      dockerfile: Dockerfile
    ports:
      - "5001:5001"
    env_file:
      - ./.env
    environment:
      - FRONTEND_PORT=5001
      - CALENDAR_BASE_URL=http://calendar-service:5003
    depends_on:
      calendar-service:
        condition: service_healthy
    restart: unless-stopped